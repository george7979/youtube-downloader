# Cursor Rules - ReguÅ‚y pracy w projekcie YouTube Downloader

## ðŸŽ¯ GÅÃ“WNA REGUÅA: PRACA TYLKO W KATALOGU PROJEKTU

### âœ… OBOWIÄ„ZKOWE KROKI PRZED KAÅ»DÄ„ PRACÄ„:
1. **SprawdÅº katalog roboczy:** `pwd`
2. **SprawdÅº zawartoÅ›Ä‡:** `ls -la`
3. **Upewnij siÄ™, Å¼e jesteÅ› w:** `/mnt/chromeos/GoogleDrive/MyDrive/Cursor/youtube-downloader`
4. **Dopiero potem twÃ³rz/edytuj pliki**

### ðŸš« ZAKAZANE:
- Tworzenie plikÃ³w poza katalogiem projektu
- Edytowanie plikÃ³w w katalogu nadrzÄ™dnym
- Praca w innych katalogach bez weryfikacji

### âœ… DOZWOLONE:
- Praca tylko w `/mnt/chromeos/GoogleDrive/MyDrive/Cursor/youtube-downloader`
- Tworzenie plikÃ³w tylko w tym katalogu
- Edytowanie plikÃ³w tylko w tym katalogu

### ðŸ” WERYFIKACJA:
Przed kaÅ¼dÄ… operacjÄ… sprawdÅº:
```bash
pwd && ls -la
```

### ðŸ“ STRUKTURA PROJEKTU:
```
youtube-downloader/
â”œâ”€â”€ plan.md             # Plan aplikacji
â”œâ”€â”€ requirements.txt    # ZaleÅ¼noÅ›ci
â”œâ”€â”€ main.py            # GÅ‚Ã³wny plik (do utworzenia)
â”œâ”€â”€ gui.py             # GUI (do utworzenia)
â”œâ”€â”€ downloader.py      # Logika pobierania (do utworzenia)
â”œâ”€â”€ utils.py           # Funkcje pomocnicze (do utworzenia)
â”œâ”€â”€ README.md          # Dokumentacja (do utworzenia)
â””â”€â”€ .venv/             # Åšrodowisko wirtualne
```

### ðŸŽ¯ CEL:
Wszystkie pliki aplikacji muszÄ… byÄ‡ w katalogu `youtube-downloader/` 

### ðŸ”’ GIT - ZGODA PRZED AKTUALIZACJÄ„:
**OBOWIÄ„ZKOWE:** Przed kaÅ¼dÄ… aktualizacjÄ… danych do Git (commit, push) musisz:
1. **ZapytaÄ‡ uÅ¼ytkownika o zgodÄ™** - "Czy mogÄ™ zaktualizowaÄ‡ dane w Git?"
2. **PoczekaÄ‡ na odpowiedÅº** - nie rÃ³b commit/push bez zgody
3. **OpisaÄ‡ co zostanie zmienione** - powiedz co dokÅ‚adnie zostanie zaktualizowane
4. **Dopiero po zgodzie** - wykonaj operacje Git

### âŒ ZAKAZANE W GIT:
- Commit bez pytania o zgodÄ™
- Push bez pytania o zgodÄ™
- Automatyczne aktualizacje bez zgody uÅ¼ytkownika
- Force push bez wyraÅºnej zgody

### âœ… DOZWOLONE W GIT:
- Sprawdzanie statusu: `git status`
- PodglÄ…d zmian: `git diff`
- Pytanie o zgodÄ™ przed commit/push
- Wykonywanie operacji tylko po otrzymaniu zgody

## ðŸ—ï¸ BUDOWANIE PAKIETÃ“W DEB

### âœ… PRAKTYKA BUDOWANIA PAKIETÃ“W:
1. **SprawdÅº gotowoÅ›Ä‡ systemu** - python3-venv, python3-tk, pip
2. **UÅ¼yj curl jako fallback** - jeÅ›li ensurepip nie dziaÅ‚a
3. **Instalacja w tle** - dla brakujÄ…cych pakietÃ³w systemowych
4. **Sprawdzanie zaleÅ¼noÅ›ci** - weryfikacja po instalacji
5. **Alternatywne metody** - rÄ™czne tworzenie venv jeÅ›li standardowe nie dziaÅ‚a

### ðŸ”§ KLUCZOWE ELEMENTY SKRYPTÃ“W DEB:

#### **debian/postinst - Sprawdzanie gotowoÅ›ci:**
```bash
# SprawdÅº czy system jest gotowy do tworzenia venv
echo "ðŸ” Sprawdzanie gotowoÅ›ci systemu..."

# SprawdÅº czy venv jest dostÄ™pny
if ! python3 -c "import venv" 2>/dev/null; then
    echo "âš ï¸ python3-venv nie jest dostÄ™pny"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 5; apt-get update && apt-get install -y python3-venv' >/dev/null 2>&1 &
fi

# SprawdÅº czy tkinter jest dostÄ™pny
if ! python3 -c "import tkinter" 2>/dev/null; then
    echo "âš ï¸ python3-tk nie jest dostÄ™pny"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 5; apt-get update && apt-get install -y python3-tk' >/dev/null 2>&1 &
fi

# SprawdÅº czy pip jest dostÄ™pny
if ! python3 -c "import pip" 2>/dev/null; then
    echo "âš ï¸ pip nie jest dostÄ™pny"
    echo "Instalowanie pip przez curl..."
    curl https://bootstrap.pypa.io/get-pip.py | python3
fi
```

#### **debian/postinst - Tworzenie venv z fallback:**
```bash
# PrÃ³buj standardowÄ… metodÄ™
if python3 -m venv /usr/share/youtube-downloader/venv 2>/dev/null; then
    echo "âœ… Åšrodowisko wirtualne utworzone pomyÅ›lnie"
else
    echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ utworzyÄ‡ Å›rodowiska wirtualnego"
    echo "PrÃ³bujÄ™ alternatywnÄ… metodÄ™..."
    
    # UsuÅ„ uszkodzone venv jeÅ›li istnieje
    rm -rf /usr/share/youtube-downloader/venv 2>/dev/null || true
    
    # PrÃ³buj z --without-pip
    if python3 -m venv --without-pip /usr/share/youtube-downloader/venv 2>/dev/null; then
        echo "âœ… Åšrodowisko wirtualne utworzone bez pip"
        # Zainstaluj pip w venv przez curl
        curl https://bootstrap.pypa.io/get-pip.py | /usr/share/youtube-downloader/venv/bin/python
    else
        echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ utworzyÄ‡ Å›rodowiska wirtualnego"
        echo "PrÃ³bujÄ™ rÄ™cznÄ… metodÄ™..."
        
        # RÄ™czne utworzenie venv
        mkdir -p /usr/share/youtube-downloader/venv/bin
        mkdir -p /usr/share/youtube-downloader/venv/lib/python3.*/site-packages
        mkdir -p /usr/share/youtube-downloader/venv/include
        
        # Skopiuj Python do venv
        cp $(which python3) /usr/share/youtube-downloader/venv/bin/python
        cp $(which python3) /usr/share/youtube-downloader/venv/bin/python3
        
        # UtwÃ³rz activate script
        cat > /usr/share/youtube-downloader/venv/bin/activate << 'EOF'
#!/bin/bash
export VIRTUAL_ENV="/usr/share/youtube-downloader/venv"
export PATH="$VIRTUAL_ENV/bin:$PATH"
unset PYTHONHOME
EOF
        chmod +x /usr/share/youtube-downloader/venv/bin/activate
        
        # Zainstaluj pip przez curl
        curl https://bootstrap.pypa.io/get-pip.py | /usr/share/youtube-downloader/venv/bin/python
    fi
fi
```

#### **debian/postinst - Instalacja zaleÅ¼noÅ›ci:**
```bash
# Zainstaluj zaleÅ¼noÅ›ci w Å›rodowisku wirtualnym
echo "ðŸ“š Instalowanie zaleÅ¼noÅ›ci w Å›rodowisku wirtualnym..."
if /usr/share/youtube-downloader/venv/bin/pip install yt-dlp 2>/dev/null; then
    echo "âœ… ZaleÅ¼noÅ›ci zainstalowane pomyÅ›lnie"
else
    echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ zainstalowaÄ‡ zaleÅ¼noÅ›ci"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 10; /usr/share/youtube-downloader/venv/bin/pip install yt-dlp' >/dev/null 2>&1 &
fi

# SprawdÅº czy zaleÅ¼noÅ›ci zostaÅ‚y zainstalowane poprawnie
echo "ðŸ” Sprawdzanie instalacji zaleÅ¼noÅ›ci..."
if /usr/share/youtube-downloader/venv/bin/python -c "import yt_dlp" 2>/dev/null; then
    echo "âœ… ZaleÅ¼noÅ›ci dziaÅ‚ajÄ… poprawnie"
else
    echo "âŒ BÅ‚Ä…d: ZaleÅ¼noÅ›ci nie dziaÅ‚ajÄ… poprawnie"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 10; /usr/share/youtube-downloader/venv/bin/pip install yt-dlp' >/dev/null 2>&1 &
fi
```

### ðŸš« PROBLEMY DO UNIKANIA:
- **Blokady dpkg** - uÅ¼ywaj instalacji w tle z `nohup`
- **Brak ensurepip** - uÅ¼ywaj curl jako fallback
- **Brak pip w venv** - instaluj przez curl
- **Brak zaleÅ¼noÅ›ci systemowych** - sprawdzaj przed tworzeniem venv

### âœ… DOBRE PRAKTYKI:
- **Sprawdzanie gotowoÅ›ci** - przed tworzeniem venv
- **Instalacja w tle** - dla pakietÃ³w systemowych
- **Fallback z curl** - dla pip i ensurepip
- **Weryfikacja zaleÅ¼noÅ›ci** - po instalacji
- **Alternatywne metody** - jeÅ›li standardowe nie dziaÅ‚ajÄ…

### ðŸ”„ PROCEDURA BUDOWANIA:
```bash
# 1. Przygotuj pliki DEB
sudo dpkg-buildpackage -b -us -uc

# 2. PrzenieÅ› pliki do katalogu projektu
mv ../youtube-downloader_1.0.2* . -f

# 3. Testuj instalacjÄ™
sudo dpkg -i youtube-downloader_1.0.2_all.deb

# 4. Testuj aplikacjÄ™
youtube-downloader

# 5. Deinstaluj do testÃ³w
sudo dpkg --purge youtube-downloader
```

### ðŸ“‹ STRUKTURA PAKIETU DEB:
```
youtube-downloader_1.0.2_all.deb
â”œâ”€â”€ DEBIAN/
â”‚   â”œâ”€â”€ control (zaleÅ¼noÅ›ci: python3 | python3-minimal, python3-tk)
â”‚   â”œâ”€â”€ postinst (sprawdzanie + instalacja w tle)
â”‚   â”œâ”€â”€ postrm (czysta deinstalacja)
â”‚   â””â”€â”€ prerm (usuwanie venv)
â”œâ”€â”€ usr/bin/youtube-downloader (skrypt uruchamiajÄ…cy)
â”œâ”€â”€ usr/share/applications/youtube-downloader.desktop
â”œâ”€â”€ usr/share/icons/.../youtube-downloader.png
â””â”€â”€ usr/share/youtube-downloader/ (pliki aplikacji)
```
# Cursor Rules - ReguÅ‚y pracy w projekcie YouTube Downloader

## ğŸ¯ GÅÃ“WNA REGUÅA: PRACA TYLKO W KATALOGU PROJEKTU

### âœ… OBOWIÄ„ZKOWE KROKI PRZED KAÅ»DÄ„ PRACÄ„:
1. **SprawdÅº katalog roboczy:** `pwd`
2. **SprawdÅº zawartoÅ›Ä‡:** `ls -la`
3. **Upewnij siÄ™, Å¼e jesteÅ› w katalogu projektu:** `youtube-downloader/`
4. **Dopiero potem twÃ³rz/edytuj pliki**

### ğŸš« ZAKAZANE:
- Tworzenie plikÃ³w poza katalogiem projektu
- Edytowanie plikÃ³w w katalogu nadrzÄ™dnym
- Praca w innych katalogach bez weryfikacji

### âœ… DOZWOLONE:
- Praca tylko w katalogu `youtube-downloader/`
- Tworzenie plikÃ³w tylko w tym katalogu
- Edytowanie plikÃ³w tylko w tym katalogu

### ğŸ” WERYFIKACJA:
Przed kaÅ¼dÄ… operacjÄ… sprawdÅº:
```bash
pwd && ls -la
```

**SprawdÅº czy jesteÅ› w katalogu projektu:**
- âœ… Powinno byÄ‡: `youtube-downloader/` na koÅ„cu Å›cieÅ¼ki
- âœ… Powinny byÄ‡ pliki: `main.py`, `gui.py`, `debian/`, `README.md`
- âŒ Nie powinno byÄ‡: `../youtube-downloader` lub inne katalogi

### ğŸ“ STRUKTURA PROJEKTU:
```
youtube-downloader/
â”œâ”€â”€ main.py            # GÅ‚Ã³wna aplikacja
â”œâ”€â”€ gui.py             # Interfejs uÅ¼ytkownika
â”œâ”€â”€ downloader.py      # Logika pobierania
â”œâ”€â”€ utils.py           # Funkcje pomocnicze
â”œâ”€â”€ README.md          # Dokumentacja
â”œâ”€â”€ cursorrules        # ReguÅ‚y projektu
â”œâ”€â”€ debian/            # Skrypty pakietu DEB
â”‚   â”œâ”€â”€ control        # Metadane pakietu
â”‚   â”œâ”€â”€ postinst       # Skrypt instalacji
â”‚   â”œâ”€â”€ postrm         # Skrypt deinstalacji
â”‚   â”œâ”€â”€ prerm          # Skrypt przed usuniÄ™ciem
â”‚   â””â”€â”€ rules          # ReguÅ‚y budowania
â”œâ”€â”€ pics/              # Zasoby graficzne
â”œâ”€â”€ *.deb              # Pliki pakietÃ³w (prywatne repo)
â””â”€â”€ .gitignore         # Pliki ignorowane przez Git
```

### ğŸ¯ CEL:
Wszystkie pliki aplikacji muszÄ… byÄ‡ w katalogu `youtube-downloader/` 

### ğŸ”’ GIT - ZGODA PRZED AKTUALIZACJÄ„:
**OBOWIÄ„ZKOWE:** Przed kaÅ¼dÄ… aktualizacjÄ… danych do Git (commit, push) musisz:
1. **ZapytaÄ‡ uÅ¼ytkownika o zgodÄ™** - "Czy mogÄ™ zaktualizowaÄ‡ dane w Git?"
2. **PoczekaÄ‡ na odpowiedÅº** - nie rÃ³b commit/push bez zgody
3. **OpisaÄ‡ co zostanie zmienione** - powiedz co dokÅ‚adnie zostanie zaktualizowane
4. **Dopiero po zgodzie** - wykonaj operacje Git

### âŒ ZAKAZANE W GIT:
- Commit bez pytania o zgodÄ™
- Push bez pytania o zgodÄ™
- Automatyczne aktualizacje bez zgody uÅ¼ytkownika
- Force push bez wyraÅºnej zgody

### âœ… DOZWOLONE W GIT:
- Sprawdzanie statusu: `git status`
- PodglÄ…d zmian: `git diff`
- Pytanie o zgodÄ™ przed commit/push
- Wykonywanie operacji tylko po otrzymaniu zgody

## ğŸ—ï¸ BUDOWANIE PAKIETÃ“W DEB

### âœ… PRAKTYKA BUDOWANIA PAKIETÃ“W:
1. **SprawdÅº gotowoÅ›Ä‡ systemu** - python3-venv, python3-tk, pip
2. **UÅ¼yj curl jako fallback** - jeÅ›li ensurepip nie dziaÅ‚a
3. **Instalacja w tle** - dla brakujÄ…cych pakietÃ³w systemowych
4. **Sprawdzanie zaleÅ¼noÅ›ci** - weryfikacja po instalacji
5. **Alternatywne metody** - rÄ™czne tworzenie venv jeÅ›li standardowe nie dziaÅ‚a

### ğŸ”§ KLUCZOWE ELEMENTY SKRYPTÃ“W DEB:

#### **debian/postinst - Sprawdzanie gotowoÅ›ci:**
```bash
# SprawdÅº czy system jest gotowy do tworzenia venv
echo "ğŸ” Sprawdzanie gotowoÅ›ci systemu..."

# SprawdÅº czy venv jest dostÄ™pny
if ! python3 -c "import venv" 2>/dev/null; then
    echo "âš ï¸ python3-venv nie jest dostÄ™pny"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 5; apt-get update && apt-get install -y python3-venv' >/dev/null 2>&1 &
fi

# SprawdÅº czy tkinter jest dostÄ™pny
if ! python3 -c "import tkinter" 2>/dev/null; then
    echo "âš ï¸ python3-tk nie jest dostÄ™pny"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 5; apt-get update && apt-get install -y python3-tk' >/dev/null 2>&1 &
fi

# SprawdÅº czy pip jest dostÄ™pny
if ! python3 -c "import pip" 2>/dev/null; then
    echo "âš ï¸ pip nie jest dostÄ™pny"
    echo "Instalowanie pip przez curl..."
    curl https://bootstrap.pypa.io/get-pip.py | python3
fi
```

#### **debian/postinst - Tworzenie venv z fallback:**
```bash
# PrÃ³buj standardowÄ… metodÄ™
if python3 -m venv /usr/share/youtube-downloader/venv 2>/dev/null; then
    echo "âœ… Åšrodowisko wirtualne utworzone pomyÅ›lnie"
else
    echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ utworzyÄ‡ Å›rodowiska wirtualnego"
    echo "PrÃ³bujÄ™ alternatywnÄ… metodÄ™..."
    
    # UsuÅ„ uszkodzone venv jeÅ›li istnieje
    rm -rf /usr/share/youtube-downloader/venv 2>/dev/null || true
    
    # PrÃ³buj z --without-pip
    if python3 -m venv --without-pip /usr/share/youtube-downloader/venv 2>/dev/null; then
        echo "âœ… Åšrodowisko wirtualne utworzone bez pip"
        # Zainstaluj pip w venv przez curl
        curl https://bootstrap.pypa.io/get-pip.py | /usr/share/youtube-downloader/venv/bin/python
    else
        echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ utworzyÄ‡ Å›rodowiska wirtualnego"
        echo "PrÃ³bujÄ™ rÄ™cznÄ… metodÄ™..."
        
        # RÄ™czne utworzenie venv
        mkdir -p /usr/share/youtube-downloader/venv/bin
        mkdir -p /usr/share/youtube-downloader/venv/lib/python3.*/site-packages
        mkdir -p /usr/share/youtube-downloader/venv/include
        
        # Skopiuj Python do venv
        cp $(which python3) /usr/share/youtube-downloader/venv/bin/python
        cp $(which python3) /usr/share/youtube-downloader/venv/bin/python3
        
        # UtwÃ³rz activate script
        cat > /usr/share/youtube-downloader/venv/bin/activate << 'EOF'
#!/bin/bash
export VIRTUAL_ENV="/usr/share/youtube-downloader/venv"
export PATH="$VIRTUAL_ENV/bin:$PATH"
unset PYTHONHOME
EOF
        chmod +x /usr/share/youtube-downloader/venv/bin/activate
        
        # Zainstaluj pip przez curl
        curl https://bootstrap.pypa.io/get-pip.py | /usr/share/youtube-downloader/venv/bin/python
    fi
fi
```

#### **debian/postinst - Instalacja zaleÅ¼noÅ›ci:**
```bash
# Zainstaluj zaleÅ¼noÅ›ci w Å›rodowisku wirtualnym
echo "ğŸ“š Instalowanie zaleÅ¼noÅ›ci w Å›rodowisku wirtualnym..."
if /usr/share/youtube-downloader/venv/bin/pip install yt-dlp 2>/dev/null; then
    echo "âœ… ZaleÅ¼noÅ›ci zainstalowane pomyÅ›lnie"
else
    echo "âŒ BÅ‚Ä…d: Nie udaÅ‚o siÄ™ zainstalowaÄ‡ zaleÅ¼noÅ›ci"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 10; /usr/share/youtube-downloader/venv/bin/pip install yt-dlp' >/dev/null 2>&1 &
fi

# SprawdÅº czy zaleÅ¼noÅ›ci zostaÅ‚y zainstalowane poprawnie
echo "ğŸ” Sprawdzanie instalacji zaleÅ¼noÅ›ci..."
if /usr/share/youtube-downloader/venv/bin/python -c "import yt_dlp" 2>/dev/null; then
    echo "âœ… ZaleÅ¼noÅ›ci dziaÅ‚ajÄ… poprawnie"
else
    echo "âŒ BÅ‚Ä…d: ZaleÅ¼noÅ›ci nie dziaÅ‚ajÄ… poprawnie"
    echo "Instalowanie w tle..."
    nohup bash -c 'sleep 10; /usr/share/youtube-downloader/venv/bin/pip install yt-dlp' >/dev/null 2>&1 &
fi
```

### ğŸš« PROBLEMY DO UNIKANIA:
- **Blokady dpkg** - uÅ¼ywaj instalacji w tle z `nohup`
- **Brak ensurepip** - uÅ¼ywaj curl jako fallback
- **Brak pip w venv** - instaluj przez curl
- **Brak zaleÅ¼noÅ›ci systemowych** - sprawdzaj przed tworzeniem venv

### âœ… DOBRE PRAKTYKI:
- **Sprawdzanie gotowoÅ›ci** - przed tworzeniem venv
- **Instalacja w tle** - dla pakietÃ³w systemowych
- **Fallback z curl** - dla pip i ensurepip
- **Weryfikacja zaleÅ¼noÅ›ci** - po instalacji
- **Alternatywne metody** - jeÅ›li standardowe nie dziaÅ‚ajÄ…

### ğŸ”„ PROCEDURA BUDOWANIA I TESTOWANIA:
```bash
# 1. Przygotuj pliki DEB
sudo dpkg-buildpackage -b -us -uc

# 2. PrzenieÅ› pliki do katalogu projektu
mv ../youtube-downloader_* . -f

# 3. Testuj instalacjÄ™
sudo dpkg -i youtube-downloader_*.deb

# 4. Testuj aplikacjÄ™
youtube-downloader

# 5. Deinstaluj do testÃ³w
sudo dpkg --purge youtube-downloader
```

## ğŸ“¤ ZASADY WYPYCHANIA DO REPOZYTORIÃ“W

### ğŸ¯ **DWA REPOZYTORIA:**

#### **1. PUBLICZNE REPO (origin)**
- **URL:** https://github.com/george7979/youtube-downloader
- **Cel:** Kod ÅºrÃ³dÅ‚owy dla spoÅ‚ecznoÅ›ci
- **ZawartoÅ›Ä‡:** Kod Python, skrypty Debian, dokumentacja
- **NIE zawiera:** Pliki DEB, buildinfo, changes

#### **2. PRYWATNE REPO (private)**
- **URL:** https://github.com/george7979/youtube-downloader-private
- **Cel:** PeÅ‚ny projekt roboczy
- **ZawartoÅ›Ä‡:** Wszystko + pliki DEB, buildinfo, changes

### ğŸ“‹ **ZASADY WYPYCHANIA:**

#### **Do publicznego repo (origin):**
```bash
# 1. Dodaj zmiany (automatycznie ignoruje pliki DEB)
git add .

# 2. Commit
git commit -m "Opis zmian"

# 3. Push do publicznego
git push origin master
```

#### **Do prywatnego repo (private):**
```bash
# 1. Dodaj zmiany
git add .

# 2. Dodaj pliki DEB (force add - ignoruje .gitignore)
git add -f *.deb *.buildinfo *.changes cursorrules

# 3. Commit
git commit -m "Opis zmian + pliki DEB"

# 4. Push do prywatnego
git push private master
```

### ğŸ”„ **PRACA Z DWOMA REPO:**

#### **Nowa funkcja:**
```bash
# 1. Rozwij funkcjÄ™
# 2. Testuj
# 3. Zbuduj i przetestuj DEB (patrz: PROCEDURA BUDOWANIA I TESTOWANIA)
sudo dpkg-buildpackage -b -us -uc
mv ../youtube-downloader_* .

# 4. Push do prywatnego (z DEB)
git add .
git add -f *.deb *.buildinfo *.changes cursorrules
git commit -m "Nowa funkcja + DEB"
git push private master

# 5. Push do publicznego (bez DEB - automatycznie)
git add .
git commit -m "Nowa funkcja"
git push origin master
```

#### **Aktualizacja .gitignore:**
```bash
# 1. Edytuj .gitignore
# 2. Push do obu repo
git add .gitignore
git commit -m "Aktualizacja .gitignore"
git push origin master
git push private master
```

#### **WaÅ¼ne zasady .gitignore:**
- **Pliki DEB:** `*.deb`, `*.buildinfo`, `*.changes` - tylko w prywatnym repo
- **Cursor rules:** `cursorrules` - tylko w prywatnym repo
- **Automatyczna ochrona:** .gitignore chroni publiczne repo
- **Force add:** `git add -f` dla plikÃ³w ignorowanych w prywatnym repo

### âš ï¸ **WAÅ»NE ZASADY:**
- **Publiczne repo:** Tylko kod ÅºrÃ³dÅ‚owy (automatycznie chronione przez .gitignore)
- **Prywatne repo:** Wszystko + artefakty budowania (force add dla ignorowanych plikÃ³w)
- **Zawsze pytaj:** Przed push do publicznego repo
- **Testuj:** Przed push do publicznego repo
- **Dokumentuj:** Zmiany w cursorrules
- **Force add:** UÅ¼ywaj `git add -f` dla plikÃ³w DEB w prywatnym repo

### ğŸ“‹ STRUKTURA PAKIETU DEB:
```
youtube-downloader_1.0.2_all.deb
â”œâ”€â”€ DEBIAN/
â”‚   â”œâ”€â”€ control (zaleÅ¼noÅ›ci: python3 | python3-minimal, python3-tk)
â”‚   â”œâ”€â”€ postinst (sprawdzanie + instalacja w tle)
â”‚   â”œâ”€â”€ postrm (czysta deinstalacja)
â”‚   â””â”€â”€ prerm (usuwanie venv)
â”œâ”€â”€ usr/bin/youtube-downloader (skrypt uruchamiajÄ…cy)
â”œâ”€â”€ usr/share/applications/youtube-downloader.desktop
â”œâ”€â”€ usr/share/icons/.../youtube-downloader.png
â””â”€â”€ usr/share/youtube-downloader/ (pliki aplikacji)
```